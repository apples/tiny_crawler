[gd_scene load_steps=37 format=3 uid="uid://cfxymdndtnfee"]

[ext_resource type="PackedScene" uid="uid://cjaobi3ouiohh" path="res://blend/lizard.blend" id="1_6sb3f"]
[ext_resource type="Script" path="res://actors/player/player.gd" id="1_uiffw"]
[ext_resource type="Script" path="res://nodes/motion_interpolator_3d.gd" id="3_1non6"]
[ext_resource type="Script" path="res://addons/jigglebones/jigglebone.gd" id="3_uxj4g"]
[ext_resource type="Script" path="res://nodes/state_machine/state_machine.gd" id="4_3kmlb"]
[ext_resource type="Animation" uid="uid://b8hefmcvtspjs" path="res://blend/animations/RESET.tres" id="4_uqau1"]
[ext_resource type="Script" path="res://actors/player/state_neutral.gd" id="5_p1ua8"]
[ext_resource type="Animation" uid="uid://bsj7u7na3cdy7" path="res://blend/animations/attack1.tres" id="5_xom3j"]
[ext_resource type="Script" path="res://actors/player/state_attacking.gd" id="6_gx5xf"]
[ext_resource type="Animation" uid="uid://b7abl7kr8w8fj" path="res://blend/animations/fall.tres" id="6_q3uvi"]
[ext_resource type="Script" path="res://actors/player/state_dodge.gd" id="7_dmn1x"]
[ext_resource type="Animation" uid="uid://bpdwjnnfsfu3b" path="res://blend/animations/idle.tres" id="7_rjd7l"]
[ext_resource type="Animation" uid="uid://cb5d5d1oo0hsg" path="res://blend/animations/dodgeroll.res" id="7_un7st"]
[ext_resource type="Animation" uid="uid://lbd2mhveumo1" path="res://blend/animations/run.tres" id="8_f7tnq"]

[sub_resource type="AnimationLibrary" id="AnimationLibrary_e0piw"]
_data = {
"RESET": ExtResource("4_uqau1"),
"attack1": ExtResource("5_xom3j"),
"dodgeroll": ExtResource("7_un7st"),
"fall": ExtResource("6_q3uvi"),
"idle": ExtResource("7_rjd7l"),
"run": ExtResource("8_f7tnq")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_386be"]
animation = &"attack1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_r5grf"]
animation = &"dodgeroll"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_xmdex"]
state_machine_type = 1
states/attack1/node = SubResource("AnimationNodeAnimation_386be")
states/attack1/position = Vector2(471, 69)
states/dodgeroll/node = SubResource("AnimationNodeAnimation_r5grf")
states/dodgeroll/position = Vector2(471, 181)
graph_offset = Vector2(11, -97)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ekjjs"]
animation = &"fall"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_bjek6"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2m8sx"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3mx7g"]
animation = &"run"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_6ks4p"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_xoo8p"]
graph_offset = Vector2(-369.832, 31.3138)
nodes/Blend/node = SubResource("AnimationNodeBlend2_bjek6")
nodes/Blend/position = Vector2(220, 120)
nodes/Idle/node = SubResource("AnimationNodeAnimation_2m8sx")
nodes/Idle/position = Vector2(-139, 112)
nodes/Run/node = SubResource("AnimationNodeAnimation_3mx7g")
nodes/Run/position = Vector2(-140, 240)
nodes/RunTimeScale/node = SubResource("AnimationNodeTimeScale_6ks4p")
nodes/RunTimeScale/position = Vector2(20, 240)
nodes/output/position = Vector2(380, 120)
node_connections = [&"Blend", 0, &"Idle", &"Blend", 1, &"RunTimeScale", &"RunTimeScale", 0, &"Run", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_oi4pp"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "not is_on_floor()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r3vdq"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "is_on_floor()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_cnocx"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_q7jsv"]
states/Fall/node = SubResource("AnimationNodeAnimation_ekjjs")
states/Fall/position = Vector2(639, 100)
states/IdleRun/node = SubResource("AnimationNodeBlendTree_xoo8p")
states/IdleRun/position = Vector2(426, 100)
transitions = ["IdleRun", "Fall", SubResource("AnimationNodeStateMachineTransition_oi4pp"), "Fall", "IdleRun", SubResource("AnimationNodeStateMachineTransition_r3vdq"), "Start", "IdleRun", SubResource("AnimationNodeStateMachineTransition_cnocx")]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_p15tj"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pnov3"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tqhvc"]
xfade_time = 0.1
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_eyecr"]
states/Actions/node = SubResource("AnimationNodeStateMachine_xmdex")
states/Actions/position = Vector2(458, 176)
states/Movement/node = SubResource("AnimationNodeStateMachine_q7jsv")
states/Movement/position = Vector2(458, 70)
transitions = ["Start", "Movement", SubResource("AnimationNodeStateMachineTransition_p15tj"), "Movement", "Actions", SubResource("AnimationNodeStateMachineTransition_pnov3"), "Actions", "Movement", SubResource("AnimationNodeStateMachineTransition_tqhvc")]
graph_offset = Vector2(-51, -38)

[sub_resource type="SphereShape3D" id="SphereShape3D_qgrsn"]
radius = 0.25

[sub_resource type="CylinderShape3D" id="CylinderShape3D_t45pp"]
radius = 0.25

[sub_resource type="CylinderShape3D" id="CylinderShape3D_vtwtn"]
margin = 0.001
height = 1.999
radius = 0.249

[sub_resource type="BoxShape3D" id="BoxShape3D_yqmr2"]
size = Vector3(1.84962, 1.99988, 1.96018)

[node name="Player" instance=ExtResource("1_6sb3f")]
collision_layer = 2
floor_snap_length = 0.6
script = ExtResource("1_uiffw")

[node name="Armature" parent="." index="0"]
top_level = true

[node name="Skeleton3D" parent="Armature" index="0"]
bones/2/rotation = Quaternion(-0.562863, -0.415679, -0.469839, 0.538189)
bones/2/scale = Vector3(1, 1, 1)
bones/4/scale = Vector3(1, 1, 1)
bones/6/rotation = Quaternion(-0.57436, -0.366359, -0.11416, 0.72309)
bones/6/scale = Vector3(1, 1, 1)
bones/7/rotation = Quaternion(-0.57436, 0.366359, 0.11416, 0.72309)
bones/7/scale = Vector3(1, 1, 1)
bones/8/rotation = Quaternion(0.994898, 0, 0, -0.100888)
bones/8/scale = Vector3(1, 1, 1)
bones/9/rotation = Quaternion(-0.562863, 0.415678, 0.469839, 0.53819)
bones/9/scale = Vector3(1, 1, 1)
bones/11/rotation = Quaternion(-0.23655, -0.0321627, -0.149919, 0.959445)
bones/13/rotation = Quaternion(0.709438, -0.0263007, 0.704213, -0.00952185)
bones/13/scale = Vector3(1, 1, 1)
bones/15/rotation = Quaternion(-0.000145374, 8.50136e-06, -0.7506, 0.660757)
bones/15/scale = Vector3(1, 1, 1)
bones/16/rotation = Quaternion(0.873921, 0, 0, -0.486068)
bones/16/scale = Vector3(1, 1, 1)
bones/17/rotation = Quaternion(0.348274, 0, 0, 0.937393)
bones/18/scale = Vector3(1, 1, 1)
bones/20/rotation = Quaternion(-0.595108, 0, 0, 0.803646)
bones/21/rotation = Quaternion(-0.288007, 0, 0, 0.957628)
bones/23/rotation = Quaternion(-0.709438, -0.0263007, 0.704213, 0.00952185)
bones/23/scale = Vector3(1, 1, 1)
bones/25/rotation = Quaternion(-0.000145374, -8.50136e-06, 0.7506, 0.660757)
bones/25/scale = Vector3(1, 1, 1)
bones/27/rotation = Quaternion(0.506084, 0.493841, 0.493841, 0.506084)
bones/28/scale = Vector3(1, 1, 1)
bones/29/scale = Vector3(1, 1, 1)
bones/31/rotation = Quaternion(0.506084, -0.493841, -0.493841, 0.506084)
bones/32/scale = Vector3(1, 1, 1)
bones/33/scale = Vector3(1, 1, 1)

[node name="JiggleboneEarL" type="Node3D" parent="Armature/Skeleton3D" index="1"]
transform = Transform3D(0.705688, 0.585983, -0.398281, -0.210037, 0.709877, 0.672278, 0.676674, -0.390765, 0.624031, 0.815274, 2.34425, -0.226494)
top_level = true
script = ExtResource("3_uxj4g")
bone_name = "Ear.L"
forward_axis = 1

[node name="JiggleboneEarR" type="Node3D" parent="Armature/Skeleton3D" index="2"]
transform = Transform3D(0.705688, -0.585983, 0.39828, 0.210037, 0.709877, 0.672278, -0.676674, -0.390765, 0.624031, -0.815274, 2.34425, -0.226494)
top_level = true
script = ExtResource("3_uxj4g")
bone_name = "Ear.R"
forward_axis = 1

[node name="JiggleboneTail0" type="Node3D" parent="Armature/Skeleton3D" index="3"]
transform = Transform3D(1, 1.69219e-09, 8.77998e-12, 8.14499e-10, -0.485862, 0.874035, 1.4833e-09, -0.874035, -0.485862, 0.00271953, 0.329267, -1.00109)
top_level = true
script = ExtResource("3_uxj4g")
bone_name = "Tail0"
stiffness = 0.2
forward_axis = 1

[node name="JiggleboneHair" type="Node3D" parent="Armature/Skeleton3D" index="4"]
transform = Transform3D(1, -4.64907e-10, -1.08487e-12, -2.98715e-10, -0.64431, 0.764765, -3.56243e-10, -0.764764, -0.64431, 0.00271953, 0.911352, -0.775491)
top_level = true
script = ExtResource("3_uxj4g")
bone_name = "Hair"
stiffness = 0.5
forward_axis = 1

[node name="MotionInterpolator3D" type="Node3D" parent="Armature" index="1"]
process_priority = 2
process_physics_priority = 2
script = ExtResource("3_1non6")
target_path = NodePath("../..")
position_smoothing = 0.5
rotation_smoothing = 0.5

[node name="StateMachine" type="Node" parent="." index="1"]
unique_name_in_owner = true
script = ExtResource("4_3kmlb")
this_path = NodePath("..")

[node name="Neutral" type="Node" parent="StateMachine" index="0"]
script = ExtResource("5_p1ua8")

[node name="Attacking" type="Node" parent="StateMachine" index="1"]
script = ExtResource("6_gx5xf")

[node name="Dodge" type="Node" parent="StateMachine" index="2"]
script = ExtResource("7_dmn1x")

[node name="AnimationPlayer" parent="." index="2"]
root_motion_track = NodePath("Armature/Skeleton3D:Root")

[node name="AnimationTree" type="AnimationTree" parent="." index="3"]
unique_name_in_owner = true
root_node = NodePath("%AnimationTree/..")
root_motion_track = NodePath("Armature/Skeleton3D:Root")
libraries = {
"": SubResource("AnimationLibrary_e0piw")
}
tree_root = SubResource("AnimationNodeStateMachine_eyecr")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../AnimationPlayer")
parameters/Movement/IdleRun/Blend/blend_amount = 0
parameters/Movement/IdleRun/RunTimeScale/scale = 1.0

[node name="CameraPivot" type="Node3D" parent="." index="4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)

[node name="CameraRemoteTransform3D" type="RemoteTransform3D" parent="CameraPivot" index="0"]
remote_path = NodePath("../CameraSpringArm")
update_rotation = false

[node name="CameraSpringArm" type="SpringArm3D" parent="CameraPivot" index="1"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)
top_level = true
shape = SubResource("SphereShape3D_qgrsn")
spring_length = 3.0

[node name="CameraTarget" type="Node3D" parent="CameraPivot/CameraSpringArm" index="0"]

[node name="Camera3D" type="Camera3D" parent="." index="5"]
unique_name_in_owner = true
top_level = true
current = true

[node name="MotionInterpolator3D" type="Node3D" parent="Camera3D" index="0"]
process_priority = 1
script = ExtResource("3_1non6")
target_path = NodePath("../../CameraPivot/CameraSpringArm/CameraTarget")
position_smoothing = 0.5
rotation_smoothing = 0.5

[node name="MainCollisionShape" type="CollisionShape3D" parent="." index="6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_t45pp")

[node name="StairShapeCastUp" type="ShapeCast3D" parent="." index="7"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
enabled = false
shape = SubResource("CylinderShape3D_vtwtn")
target_position = Vector3(0, 0, 0)

[node name="StairShapeCastForward" type="ShapeCast3D" parent="." index="8"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
enabled = false
shape = SubResource("CylinderShape3D_vtwtn")
target_position = Vector3(0, 0, 0)

[node name="StairShapeCastDown" type="ShapeCast3D" parent="." index="9"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
enabled = false
shape = SubResource("CylinderShape3D_vtwtn")
target_position = Vector3(0, 0, 0)

[node name="AttackHitbox" type="Area3D" parent="." index="10"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.64384, 1.32194)
collision_layer = 4
collision_mask = 8
monitoring = false
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="AttackHitbox" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.646558, 0)
shape = SubResource("BoxShape3D_yqmr2")

[node name="RootMotionView" type="RootMotionView" parent="." index="11"]
animation_path = NodePath("../AnimationTree")
