[gd_scene load_steps=14 format=3 uid="uid://bysbeksbr5xev"]

[ext_resource type="Script" path="res://actors/skele/skele.gd" id="1_0f6wd"]
[ext_resource type="PackedScene" uid="uid://23diikqy7ade" path="res://actors/character_base/character_base.tscn" id="2_pv1av"]
[ext_resource type="AnimationLibrary" uid="uid://baxx1u8lp2y2q" path="res://blend/humanoid_lib/humanoid.blend" id="3_6kseu"]
[ext_resource type="PackedScene" uid="uid://btimrbt2m63il" path="res://blend/skele/skele.blend" id="9_nnkms"]
[ext_resource type="Script" path="res://nodes/motion_interpolator_3d.gd" id="10_1fgty"]
[ext_resource type="Script" path="res://nodes/state_machine/state_machine.gd" id="11_cooj2"]
[ext_resource type="Script" path="res://actors/skele/state_idle.gd" id="12_0ydk3"]
[ext_resource type="Script" path="res://actors/skele/state_chasing.gd" id="13_32k20"]
[ext_resource type="Script" path="res://actors/skele/state_attacking.gd" id="14_5jvry"]
[ext_resource type="PackedScene" uid="uid://b2mqxco6io0sq" path="res://components/visibility_area/visibility_area.tscn" id="15_4cpkf"]
[ext_resource type="Script" path="res://actors/skele/state_searching.gd" id="15_doy4h"]

[sub_resource type="Animation" id="Animation_8jmwy"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../CharacterBase/AttackHitbox:monitoring")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_2dgtk"]
_data = {
"RESET": SubResource("Animation_8jmwy")
}

[node name="Skele" type="Node3D"]
script = ExtResource("1_0f6wd")

[node name="CharacterBase" parent="." instance=ExtResource("2_pv1av")]
collision_layer = 8
base_move_speed_multiplier = 1.5
acceleration = 25.0

[node name="AnimationTree" parent="CharacterBase" index="0"]
root_node = NodePath("%AnimationTree/../../Skele")
root_motion_track = NodePath("%GeneralSkeleton:Root")
libraries = {
"": SubResource("AnimationLibrary_2dgtk"),
"humanoid": ExtResource("3_6kseu")
}
anim_player = NodePath("../../Skele/AnimationPlayer")

[node name="AttackHitbox" parent="CharacterBase" index="6"]
collision_layer = 16
collision_mask = 2

[node name="Skele" parent="." instance=ExtResource("9_nnkms")]

[node name="GeneralSkeleton" parent="Skele/Armature" index="0"]
bones/1/position = Vector3(0.00225623, 0.811098, 9.86231e-11)
bones/1/rotation = Quaternion(0.0258106, -6.73067e-18, 3.80711e-17, 0.999667)
bones/2/rotation = Quaternion(0.216274, 0.679359, -0.125329, 0.689919)
bones/3/rotation = Quaternion(0.171431, -0.68069, 0.253589, 0.665557)
bones/4/rotation = Quaternion(-3.1665e-08, 0.707107, -3.1665e-08, 0.707107)
bones/5/rotation = Quaternion(0.306892, -1.08914e-17, 7.00123e-17, 0.951744)
bones/6/rotation = Quaternion(0.245467, -0.669387, 0.10536, 0.693229)
bones/7/rotation = Quaternion(0.175156, 0.679322, -0.259101, 0.663859)
bones/9/rotation = Quaternion(-0.0393824, 0.653022, 0.744946, -0.130641)
bones/10/rotation = Quaternion(0.265365, 0.62571, -0.733518, -0.00436901)
bones/11/rotation = Quaternion(0.00265989, 0.296538, 0.953378, 0.0559296)
bones/12/rotation = Quaternion(-0.0716941, 0.97754, -0.198176, 0.00118015)
bones/13/position = Vector3(0.325908, 1.38928, 0.152652)
bones/13/rotation = Quaternion(0.269288, -0.0695852, 0.639523, 0.716695)
bones/14/position = Vector3(-0.0128508, 0.324014, 0.777033)
bones/15/position = Vector3(0.0878015, 0.270881, 0.160326)
bones/15/rotation = Quaternion(0.471713, -7.45058e-09, 5.96047e-08, 0.881752)
bones/16/position = Vector3(-4.48375e-06, -1.64522e-05, 2.92753e-05)
bones/16/rotation = Quaternion(-3.68785e-08, 0.707107, 0.707107, -3.68785e-08)
bones/17/position = Vector3(0.191738, 1.18916, -0.470641)
bones/17/rotation = Quaternion(-8.9407e-08, 9.31323e-10, 0, 1)
bones/18/position = Vector3(-0.325908, 1.37941, 0.174857)
bones/18/rotation = Quaternion(0.374825, 0.16573, -0.621583, 0.667589)
bones/19/rotation = Quaternion(-9.45931e-09, -0.707107, 0, 0.707107)
bones/19/scale = Vector3(1, 1, 1)
bones/20/position = Vector3(-0.0837318, 0.324014, 0.515325)
bones/21/position = Vector3(-0.0952033, 0.0182724, 0.153835)
bones/21/rotation = Quaternion(0.313176, 6.14673e-08, 1.49012e-08, 0.949695)
bones/22/position = Vector3(4.5267e-09, -1.28121e-09, 7.71257e-09)
bones/22/rotation = Quaternion(3.68785e-08, 0.707107, 0.707107, 3.68785e-08)
bones/23/position = Vector3(-0.191738, 1.18916, -0.470641)
bones/23/rotation = Quaternion(-8.9407e-08, -9.31323e-10, 0, 1)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Skele"]
root_motion_track = NodePath("%GeneralSkeleton:Root")
libraries = {
"": SubResource("AnimationLibrary_2dgtk"),
"humanoid": ExtResource("3_6kseu")
}

[node name="MotionInterpolator3D" type="Node3D" parent="Skele"]
process_priority = 1
script = ExtResource("10_1fgty")
target_path = NodePath("../../CharacterBase")
rotation_smoothing = 0.5

[node name="StateMachine" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("11_cooj2")
character_path = NodePath("../CharacterBase")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("12_0ydk3")

[node name="Chasing" type="Node" parent="StateMachine"]
script = ExtResource("13_32k20")

[node name="Attacking" type="Node" parent="StateMachine"]
script = ExtResource("14_5jvry")

[node name="Searching" type="Node" parent="StateMachine"]
script = ExtResource("15_doy4h")

[node name="VisibilityArea" parent="." instance=ExtResource("15_4cpkf")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
target_desired_distance = 2.0
path_height_offset = 0.5
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 1, 1)

[connection signal="process_done" from="CharacterBase" to="." method="_on_character_base_process_done"]

[editable path="CharacterBase"]
[editable path="Skele"]
